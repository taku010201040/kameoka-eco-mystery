# GAS完結型ダッシュボード セットアップ手順

**React不要！Google Apps Scriptだけで動く予約管理ダッシュボード**

---

## 📋 必要なファイル

1. `dashboard-standalone.gs` - バックエンドコード
2. `Dashboard.html` - フロントエンドHTML

この2つをGoogle Apps Scriptプロジェクトにアップロードするだけ！

---

## 🚀 セットアップ手順

### 1. Google Apps Scriptプロジェクトを開く

1. スプレッドシートを開く
   https://docs.google.com/spreadsheets/d/1qoP7HiN5tgkV8ONKknkhcK7Q3oCyahzobE2LaR2MYTk/edit

2. メニューから **拡張機能 > Apps Script** を選択

### 2. ファイルをアップロード

#### `dashboard-standalone.gs` をコピー

1. Apps Scriptエディタで、既存の `Code.gs` は**そのまま**（触らない）
2. 左側のファイルリストで **+** ボタン → **スクリプト** を選択
3. ファイル名を `dashboard-standalone` に変更
4. `dashboard-standalone.gs` の内容を全てコピー&ペースト
5. **保存**

#### `Dashboard.html` をアップロード

1. 左側のファイルリストで **+** ボタン → **HTML** を選択
2. ファイル名を `Dashboard` に変更
3. `Dashboard.html` の内容を全てコピー&ペースト
4. **保存**

### 3. ウェブアプリとしてデプロイ

1. 右上の **デプロイ** ボタン → **新しいデプロイ** を選択

2. **種類の選択** で ⚙️ アイコンをクリック → **ウェブアプリ** を選択

3. 設定を入力:
   - **説明**: `予約管理ダッシュボード`
   - **次のユーザーとして実行**: **自分**
   - **アクセスできるユーザー**: **全員**

4. **デプロイ** ボタンをクリック

5. 権限の承認
   - **アクセスを承認** をクリック
   - Googleアカウントを選択
   - **詳細** → **（プロジェクト名）に移動** をクリック
   - **許可** をクリック

6. **ウェブアプリのURL** が表示される → これをコピー！
   - 例: `https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec`

### 4. ダッシュボードにアクセス

コピーしたURLをブラウザで開く → 完成！

---

## 🎨 表示される内容

### 📊 統計サマリー
- 総予約数
- 総参加者数
- 謎解き予約数
- WS予約数

### 📅 日付選択
- 2月7日
- 2月14日

### ⏰ 時間帯別予約状況
各時間帯（10:00〜16:00）ごとに：
- 謎解き本編: 予約数/定員（6組）
- 村上なつかWS: 予約数/定員（3組）
- プログレスバー（色で混雑度を表示）
- 残り枠数
- 満席バッジ

---

## 🔄 データの更新

ブラウザをリロード（F5）すると最新データが表示されます。

---

## 📱 スマホ対応

スマホ・タブレットでもきれいに表示されます！

---

## ⚙️ カスタマイズ

### 色を変更したい場合

`Dashboard.html` の `<style>` セクションを編集：

```css
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
/* ↑ この部分の色コードを変更 */
```

### 日付を追加したい場合

`dashboard-standalone.gs` の以下の部分を編集：

```javascript
var dates = ["2026-02-07", "2026-02-14"];
// ↑ ここに日付を追加
```

---

## ⚠️ トラブルシューティング

### 「予約管理シートが見つかりません」と表示される

- スプレッドシートのシート名が「予約管理」であることを確認
- `dashboard-standalone.gs` の `SHEET_NAME` を確認

### データが更新されない

- ブラウザのキャッシュをクリア（Ctrl+Shift+Delete）
- スプレッドシートのアクセス権限を確認

### デプロイ時にエラーが出る

- `dashboard-standalone.gs` と `Dashboard.html` の両方が保存されているか確認
- ファイル名が正確に一致しているか確認

---

## 🎯 メリット

✅ **React不要** - GASだけで完結  
✅ **無料** - Google Apps Scriptは無料  
✅ **簡単** - ファイル2つだけ  
✅ **高速** - サーバーレス  
✅ **安全** - Googleのインフラで動作  

---

以上でセットアップ完了です！
